<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: api.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: api.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict';

/**
 * @file Creates wrappers for the Aurora API calls and provides a promise-based framework to interact with the result. This file uses ./audio.js's AudioFile class extensively and does not deal with the high level objects in index.js
 */

const axios = require('axios');
let https = require('https');
https.post = require('https-post');

const AudioFile = require('./audio');

const BASE_URL = "https://api.auroraapi.com";
const TTS_URL = BASE_URL + "/v1/tts/";
const STT_URL = BASE_URL + "/v1/stt/";
const INTERPRET_URL = BASE_URL + "/v1/interpret/";

const TTS_PATH = '/v1/tts/';
const STT_PATH = '/v1/stt/';
const INTERPRET_PATH = '/v1/interpret/';

const CONTENT_TYPE = "Content-Type";
const WAV_MIMETYPE = "audio/wav";

module.exports.getHeaders = function() {
	return {
		"X-Application-ID": global.aurora.store['appId'],
		"X-Application-Token": global.aurora.store['appToken'],
		"X-Device-ID": global.aurora.store['deviceId']
	};
}

/**
 * Using Aurora's network API calls, converts the input text to a promise
 * for an AudioFile.
 * @param {string} text - The text to be converted into speech.
 * @return {Promise&lt;AudioFile>} - A promise to obtain an AudioFile.
 */
module.exports.getTTS = function(text) {
	let headers = this.getHeaders();
	let instance = axios.create({
		baseURL: BASE_URL,
		timeout: 4000,
		method: 'get',
		headers: headers,
		params: {
			'text': text
		},
		responseType: 'stream',
	});

	return instance.get(TTS_URL)
	.then((httpReponse) => {
		return AudioFile.createFromStream(httpReponse.data);
	});
}

/**
 * @typedef {Object} InterpretObject
 * @property {string} text - The input text to be interpreted.
 * @property {string} intent - A one word categorization denoting the intent of the text. 
 * @property {Object} entities - An object containing other relevant properties given in key-value pairs. 
 */

/**
 * Using Aurora's network API calls, converts the input text to a promise
 * for interpretation of that text.
 * @param {string} text - The text to be interpreted.
 * @return {Promise&lt;InterpretObject>} - A promise to obtain interpretation data.
 */
module.exports.getInterpret = function(text) {
	let headers = this.getHeaders();
	let instance = axios.create({
		baseURL: BASE_URL,
		timeout: 4000,
		method: 'get',
		headers: headers,
		params: {
			'text': text
		},
		responseType: 'json',
	});

	return instance.get(INTERPRET_URL)
	.then((httpResponse) => {
		return httpResponse.data;
	});
}

/**
 * @typedef {Object} TextTranscript
 * @property {string} transcript - A transcript of input audio.
 */

/**
 * Using Aurora's network API calls, converts the input AudioFile to a promise
 * for a text transcript.
 * @param {AudioFile} audio - The audio to be converted into text.
 * @return {Promise&lt;TextTranscript>} - A promise to obtain json data transcribing the data.
 */
module.exports.getSTT = function(audio) {
	let headers = this.getHeaders();
	headers[CONTENT_TYPE] = WAV_MIMETYPE;
	let instance = axios.create({
		baseURL: BASE_URL,
		timeout: 4000,
		method: 'post',
		headers: headers,
		responseType: 'json'
	});

	return instance.post(STT_URL, audio.getWav())
	.then((httpResponse) => {
		return httpResponse.data;
	});
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Interpret.html">Interpret</a></li><li><a href="module.exports.html">exports</a></li><li><a href="module.exports_module.exports.html">exports</a></li><li><a href="Speech.html">Speech</a></li><li><a href="Text.html">Text</a></li></ul><h3>Global</h3><ul><li><a href="global.html#getInterpret">getInterpret</a></li><li><a href="global.html#getSTT">getSTT</a></li><li><a href="global.html#getTTS">getTTS</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Wed Mar 14 2018 12:26:51 GMT-0700 (PDT)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
